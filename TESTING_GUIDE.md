# 音頻設定改進測試指南

## 🎯 測試目標
驗證動態音頻設定改進是否解決"同一首歌時間長短不一樣"的問題。

## 📋 測試準備

### 1. **測試音頻文件準備**
準備以下不同長度的音頻文件：
- **短音頻**：< 30秒（建議15-20秒）
- **中等音頻**：30-300秒（建議2-3分鐘）
- **長音頻**：> 300秒（建議5-10分鐘）

### 2. **測試環境**
- 不同瀏覽器：Chrome、Firefox、Safari
- 不同設備：桌面、筆記本、平板
- 不同性能等級：高性能、中等性能、低性能設備

## 🔍 測試步驟

### 第一階段：基本功能測試

#### 1. **音頻載入測試**
```
步驟：
1. 載入短音頻文件（<30秒）
2. 檢查控制台輸出：
   - FFT大小應該顯示為1024
   - 樣本率信息
   - 音頻長度信息

預期結果：
- 控制台顯示：Audio initialized with FFT size: 1024, Sample rate: 48000Hz, Duration: XXs
```

#### 2. **中等音頻測試**
```
步驟：
1. 載入中等音頻文件（30-300秒）
2. 檢查控制台輸出

預期結果：
- 控制台顯示：Audio initialized with FFT size: 2048, Sample rate: 48000Hz, Duration: XXs
```

#### 3. **長音頻測試**
```
步驟：
1. 載入長音頻文件（>300秒）
2. 檢查控制台輸出

預期結果：
- 控制台顯示：Audio initialized with FFT size: 4096, Sample rate: 48000Hz, Duration: XXs
```

### 第二階段：錄製功能測試

#### 1. **短音頻錄製測試**
```
步驟：
1. 載入短音頻文件
2. 開始錄製
3. 檢查控制台輸出：
   - 幀率應該顯示為60fps
   - 比特率應該顯示為12Mbps
   - 數據間隔應該顯示為500ms

預期結果：
- 控制台顯示：Recording started with FPS: 60, Bitrate: 12Mbps, Timeslice: 500ms
- 錄製時長應該與音頻長度完全一致
```

#### 2. **中等音頻錄製測試**
```
步驟：
1. 載入中等音頻文件
2. 開始錄製
3. 檢查控制台輸出

預期結果：
- 控制台顯示：Recording started with FPS: 60, Bitrate: 8Mbps, Timeslice: 1000ms
- 錄製時長應該與音頻長度完全一致
```

#### 3. **長音頻錄製測試**
```
步驟：
1. 載入長音頻文件
2. 開始錄製
3. 檢查控制台輸出

預期結果：
- 控制台顯示：Recording started with FPS: 30, Bitrate: 6Mbps, Timeslice: 2000ms
- 錄製時長應該與音頻長度完全一致
```

### 第三階段：一致性測試

#### 1. **同一音頻多次錄製測試**
```
步驟：
1. 選擇一個中等長度的音頻文件
2. 進行3次錄製
3. 比較每次錄製的時長

預期結果：
- 3次錄製的時長應該完全一致
- 誤差應該在±0.1秒以內
```

#### 2. **不同瀏覽器測試**
```
步驟：
1. 在同一個音頻文件上
2. 分別在Chrome、Firefox、Safari中錄製
3. 比較錄製時長

預期結果：
- 不同瀏覽器的錄製時長應該基本一致
- 誤差應該在±0.5秒以內
```

#### 3. **不同設備測試**
```
步驟：
1. 在同一個音頻文件上
2. 分別在高性能、中等性能、低性能設備上錄製
3. 比較錄製時長

預期結果：
- 不同設備的錄製時長應該基本一致
- 性能差異不應該影響時長準確性
```

## 📊 測試記錄表

### 音頻載入測試記錄

| 音頻長度 | FFT大小 | 樣本率 | 音頻長度 | 狀態 |
|---------|---------|--------|----------|------|
| 短音頻  |         |        |          |      |
| 中等音頻|         |        |          |      |
| 長音頻  |         |        |          |      |

### 錄製功能測試記錄

| 音頻長度 | 幀率 | 比特率 | 數據間隔 | 錄製時長 | 音頻長度 | 誤差 | 狀態 |
|---------|------|--------|----------|----------|----------|------|------|
| 短音頻  |      |        |          |          |          |      |      |
| 中等音頻|      |        |          |          |          |      |      |
| 長音頻  |      |        |          |          |          |      |      |

### 一致性測試記錄

| 測試項目 | 錄製1時長 | 錄製2時長 | 錄製3時長 | 平均時長 | 最大誤差 | 狀態 |
|---------|-----------|-----------|-----------|----------|----------|------|
| 同一音頻多次錄製 | | | | | | |
| Chrome錄製 | | | | | | |
| Firefox錄製 | | | | | | |
| Safari錄製 | | | | | | |
| 高性能設備 | | | | | | |
| 中等性能設備 | | | | | | |
| 低性能設備 | | | | | | |

## 🔧 調試信息檢查

### 控制台輸出檢查點

#### 音頻初始化信息
```
Audio initialized with FFT size: [1024/2048/4096], Sample rate: [48000/44100]Hz, Duration: [XX]s
```

#### 錄製開始信息
```
Recording started with FPS: [30/60], Bitrate: [6/8/12]Mbps, Timeslice: [500/1000/2000]ms
```

#### 音頻信息檢查
```javascript
// 在瀏覽器控制台執行
const audioInfo = getAudioInfo();
console.log('Audio Info:', audioInfo);
```

#### 錄製信息檢查
```javascript
// 在瀏覽器控制台執行
const recordingInfo = getRecordingInfo();
console.log('Recording Info:', recordingInfo);
```

## 🚨 問題診斷

### 常見問題及解決方案

#### 1. **FFT大小不正確**
```
問題：控制台顯示的FFT大小與預期不符
解決：檢查音頻文件長度是否正確載入
```

#### 2. **錄製時長不一致**
```
問題：多次錄製同一音頻，時長不一致
解決：檢查瀏覽器性能、關閉其他程序
```

#### 3. **控制台沒有輸出**
```
問題：沒有看到預期的控制台信息
解決：檢查瀏覽器控制台設置、確認代碼已更新
```

#### 4. **錄製失敗**
```
問題：錄製過程中出現錯誤
解決：檢查瀏覽器權限、音頻文件格式
```

## ✅ 成功標準

### 基本標準
- [ ] 所有音頻文件都能正確載入
- [ ] FFT大小根據音頻長度正確調整
- [ ] 錄製功能正常工作
- [ ] 控制台輸出正確信息

### 高級標準
- [ ] 同一音頻多次錄製時長一致（誤差<0.1秒）
- [ ] 不同瀏覽器錄製時長一致（誤差<0.5秒）
- [ ] 不同設備錄製時長一致（誤差<0.5秒）
- [ ] 性能優化效果明顯

## 📝 測試報告模板

### 測試總結
```
測試日期：[日期]
測試版本：[版本號]
測試人員：[姓名]

總體結果：[通過/失敗]
主要問題：[問題描述]
改進建議：[建議內容]
```

### 詳細結果
```
1. 音頻載入測試：[通過/失敗]
2. 錄製功能測試：[通過/失敗]
3. 一致性測試：[通過/失敗]
4. 性能測試：[通過/失敗]
```

這個測試指南將幫助我們全面驗證音頻設定改進的效果，確保"同一首歌時間長短不一樣"的問題得到解決。
